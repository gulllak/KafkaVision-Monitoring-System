### KafkaVision Monitoring System - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π (Apache Kafka). –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å-–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Ç—Ä–∏–∫–∞—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

_–°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è **Producer** –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ—Ç—Ä–∏–∫, **Consumer** –¥–ª—è –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞, –∞ —Ç–∞–∫–∂–µ REST API –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–µ—Ç—Ä–∏–∫._ 

#### –í –ë–î —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
- –ò–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–∑–≤–∞–Ω –º–µ—Ç–æ–¥
- –ê–¥–µ—Ä—Å —ç–Ω–¥–ø–æ–∏—Ç–∞
- IP –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—Ä–∞—Ç–∏–≤—à–µ–≥–æ—Å—è –∫ —ç–Ω–¥–ø–æ–Ω—Ç—É (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ HttpServletRequest)
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

### REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

–î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è api, –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª **_KafkaVision.postman_collection.json_**, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Postman.

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç.
    ```bash
   $ git clone https://github.com/gulllak/KafkaVision-Monitoring-System.git
   ```
2. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Idea –∏ –≤ –∫–æ–Ω—Å–æ–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å common-dto –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Maven.
    ```bash
   $ cd common-dto && mvn clean install && cd ..
   ```
3. –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–∏–≤ –∫–æ–º–∞–Ω–¥—É
   ```bash
   $ mvn clean package
   ```
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É docker-compose –∫–æ–º–∞–Ω–¥–æ–π
   ```bash
   $ docker-compose up
   ```
5. –¢–µ–ø–µ—Ä—å —Å –ø–æ–º–æ—à—å—é Postman —Å –ø–æ–º–æ—à—å—é —Ñ–∞–ª–π–∞ **KafkaVision.postman_collection.json** –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ. 
–î–ª—è –Ω–∞—á–∞–ª–∞ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å **FillTestData**, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ë–î —Ä–∞–Ω–¥–æ–º–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
6. –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É http://localhost:8080/swagger-ui.html

#### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å MetricsProducer
1. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–Ω–¥–æ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î):
```
GET http://localhost:8080/metrics
```
–ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç:
```
   –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã
   ```
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å json –æ–±—ä–µ–∫—Ç –≤ Kafka:
```
POST http://localhost:8080/metrics
```
–ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
```
Json —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ç–æ–ø–∏–∫ Kafka
   ```
#### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å MetricsConsumer
1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫:
```
GET http://localhost:9090/stats
```
–ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
```
[
    {
        "id": 1,
        "app": "exampleApp",
        "uri": "/example/uri",
        "ip": "192.168.1.1",
        "timestamp": "2023-10-02T15:30:00"
    },
    {
        "id": 2,
        "app": "App2",
        "uri": "/login",
        "ip": "253.10.251.125",
        "timestamp": "2024-05-16T14:09:14.578949"
    },
    ...
]
   ```
2. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ id:
```
GET http://localhost:9090/stats/{id}
```
–ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
```
{
    "id": 1,
    "app": "exampleApp",
    "uri": "/example/uri",
    "ip": "192.168.1.1",
    "timestamp": "2023-10-02T15:30:00"
}
```
3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º.
   –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `unique=true`, —Ç–æ –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
```
GET http://localhost:9090/stats/hits?unique=true
```
–ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
```
[
    {
        "app": "App1",
        "uri": "/booking/book/1",
        "hits": 40
    },
    {
        "app": "App2",
        "uri": "/login",
        "hits": 31
    },
    ...
]
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –ë–î –≤ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ 
1. –í –∫–æ–Ω—Å–æ–ª–µ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∏ —É–∑–Ω–∞—Ç—å **CONTAINER ID** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –∏–º–µ–Ω–µ–º **MetricsDB** (–ø—Ä–∏–º–µ—Ä 88ef51c073d3):
```bash
   $  docker ps
   ```
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É 
```bash
   $  docker exec -it <container_id> /bin/bash
   $  psql -U evgenii -d metricsdb
   ```
3. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –ë–î –∏ —É–±–µ–¥–∏—Ç—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ MetricsProdu—Åer –≤ Kafka, 
—É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–Ω—è—Ç—ã –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–º MetricsConsumer –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î.
```bash
   $  SELECT * FROM endpoints;
   ```
–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
    id  | app  |       uri       |       ip        |        request_time        
-----+------+-----------------+-----------------+----------------------------
   1 | App1 | /login          | 166.39.54.255   | 2024-05-17 19:40:27.250514
   2 | App3 | /booking/book/1 | 40.166.0.170    | 2024-05-17 19:40:27.384763
   3 | App3 | /register/new   | 245.134.125.82  | 2024-05-17 19:40:27.385303
   ```
### üèÑ –°—Ç–µ–∫:
Java 21, SpringBoot 3, Kafka, Docker, PostgreSQL, Liquibase, Maven, SpringDoc OpenAPI.
